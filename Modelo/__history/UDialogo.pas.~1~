unit UDialogo;

interface

uses
    Windows
  , SysUtils
  ;

type
  EValidacao = class(Exception);

  TMensagem = class
  public
    class procedure Informacao(const csMensagem: String);
    class procedure Alerta(const csMensagem: String);
    class procedure Erro(const csMensagem: String);
    class procedure Excecao(const coExcecao: Exception);

    class function Questiona(const csMensagem: String): Boolean;
  end;

resourcestring
  STR_ATENCAO = 'Atenção';

implementation

uses
    Forms
  ;

{ TMensagem }

class procedure TMensagem.Alerta(const csMensagem: String);
begin
  Application.MessageBox(PChar(csMensagem), PChar(STR_ATENCAO), MB_OK Or MB_ICONWARNING);
end;

class procedure TMensagem.Erro(const csMensagem: String);
begin
  Application.MessageBox(PChar(csMensagem), PChar(STR_ATENCAO), MB_OK Or MB_ICONERROR);
end;

class procedure TMensagem.Excecao(const coExcecao: Exception);
begin
  if coExcecao is EValidacao then
    TMensagem.Alerta(coExcecao.Message)
  else
    TMensagem.Erro(coExcecao.Message);
end;

class procedure TMensagem.Informacao(const csMensagem: String);
begin
  Application.MessageBox(PChar(csMensagem), PChar(STR_ATENCAO), MB_OK Or MB_ICONINFORMATION);
end;

class function TMensagem.Questiona(const csMensagem: String): Boolean;
begin
  Result := Application.MessageBox(PChar(csMensagem), PChar(STR_ATENCAO), MB_YESNO Or MB_ICONQUESTION) = IDYES;
end;

end.
